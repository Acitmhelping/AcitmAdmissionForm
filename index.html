<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Akash College Student Admission Form</title>
  <link href="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.css" rel="stylesheet"/>
  <style>
    body {font-family: Arial,sans-serif; background:#f0f0f0; display:flex; justify-content:center; align-items:center; min-height:100vh; margin:0;}
    .form-container {background:white; width:1080px; border-radius:15px; box-shadow:0 8px 20px rgba(0,0,0,0.2); overflow:hidden;}
    .header {background:#0022cc; color:white; display:flex; align-items:center; padding:15px;}
    .header .logo {border:2px solid #5555ff; width:80px; height:80px; display:flex; justify-content:center; align-items:center; font-weight:bold; font-size:18px; margin-right:20px; color:black; background:white;}
    .header h1 {font-size:26px; margin:0; text-align:center; flex:1;}
    .form-body {padding:20px 40px; position:relative;}
    .form-title {text-align:center; font-size:22px; color:#ff3300; margin-bottom:25px; font-weight:bold;}
    label {font-weight:bold; margin-bottom:5px; display:inline-block; color:#0022cc;}
    input, select {padding:10px; border-radius:8px; border:1px solid #999; width:100%; margin-bottom:15px; box-sizing:border-box;}
    .row {display:flex; justify-content:space-between; gap:15px;}
    .row>div {flex:1;}
    .row>div:nth-child(2) input[type="date"], .row>div:nth-child(2) select[name="gender"] {max-width:150px;}
    .photo-upload {position:absolute; right:15px; top:20px; text-align:center;}
    #photoPreview,#finalCropped {width:150px; height:150px; border:2px dashed #aaccee; object-fit:cover; display:none; border-radius:10px; position:absolute; right:20px; top:60px;}
    .cropper-controls {display:flex; justify-content:space-between; margin-top:10px;}
    .cropper-controls button {width:32%; font-size:14px; padding:8px; border-radius:6px; border:none; background:#0022cc; color:white; cursor:pointer;}
    .cropper-controls button:hover {background:#0044ff;}
    .submit-btn {text-align:right; margin-top:20px;}
    .submit-btn button {border:none; padding:12px 30px; font-size:18px; border-radius:25px; cursor:pointer; transition:0.3s; color:white;}
    #clearForm {background:#e74c3c; margin-right:10px;}
    #submitForm {background:#27ae60;}
    #loadingOverlay {position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:9999; visibility:hidden; opacity:0; transition:0.3s; color:white; font-size:18px; font-weight:bold;}
    #loadingOverlay.active {visibility:visible; opacity:1;}
    .spinner {border:8px solid #f3f3f3; border-top:8px solid #74ebd5; border-radius:50%; width:60px; height:60px; animation:spin 1s linear infinite; margin-bottom:15px;}
    @keyframes spin {0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}

    /* Center Code field width fix */
    .row.center-code > div { flex: 0 0 200px; }
    .row.center-code input[name="centerCode"] { width: 100%; }
  </style>
</head>
<body>

<div id="loadingOverlay">
  <div class="spinner"></div>
  <div>‚è≥ Saving data, please wait...</div>
</div>

<div class="form-container">
  <div class="header">
    <div class="logo">
      <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhASzqhxMkGUUKbTHvq-V9ZsDzgyuulj5TyMLsZDqJqunz4X-JJOPDYV_icJT2uGxpZh3cyGXIVIYzCKGU-4zZpOEoDCvmI73Ty82uRcoD9OIwChurk6GpbpZkF40inO3EhZIUAeVoLhauxeLM5kG_8a4Nqb1wCKdwV0kHMy0_igN34hT1ihxUSCASZ5E4p=s192" 
           alt="Logo" style="width:70px; height:70px; object-fit:cover; border-radius:10px;">
    </div>
    <h1>AKASH COLLEGE OF IT AND MANAGEMENT</h1>
    <h3>Whatsapp üìû9616220072</h3>
  </div>

  <div class="form-body">
    <div class="form-title">STUDENT ADMISSION FORM</div>

    <form id="studentForm">
      <div class="photo-upload">
        <input type="file" id="photoInput" accept="image/*" required>
        <img id="photoPreview">
        <div class="cropper-controls" id="cropperButtons" style="display:none;">
          <button type="button" id="zoomIn">Zoom +</button>
          <button type="button" id="zoomOut">Zoom -</button>
          <button type="button" id="rotate">Rotate ‚ü≥</button>
          <button type="button" id="cropButton">Crop ‚úÖ</button>
        </div>
        <img id="finalCropped">
      </div>

      <!-- Center Code field -->
      <div class="row center-code">
        <div>
          <label>Center Code:</label>
          <input type="text" name="centerCode" required>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Full Name:</label>
          <input type="text" name="name" required>
        </div>
        <div>
          <label>Admission Date:</label>
          <input type="date" name="admissionDate" required>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Father Name:</label>
          <input type="text" name="fatherName" required>
        </div>
        <div>
          <label>Gender:</label>
          <select name="gender" required>
            <option value="">--Select--</option>
            <option>Male</option>
            <option>Female</option>
            <option>Other</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Course:</label>
          <select name="course" required>
            <option value="">--Select--</option>
            <option>ADCA(Advanced Diploma in Computer Applications)</option>
            <option>DCA(Diploma in Computer Applications)</option>
            <option>CCC(Course on Computer Concepts)</option>
            <option>PGDCA(Post Graduate Diploma in Computer Applications)</option>
            <option>Typing(Hindi/English)</option>
            <option>Advanced Excel</option>
            <option>DEO(Data Entry Operator)</option>
            <option>Tally with GST</option>
            <option>AI Master Tool</option>
            <option>Canva Pro</option>
            <option>Hardware & Networking</option>
            <option>Web Designing (HTML, CSS, JS)</option>
            <option>Graphic Designing (CorelDRAW + Photoshop)</option>
            <option>MS Office (Word, Excel, PowerPoint)</option>
            <option>Video Editing (Filmora / Premiere Pro / Capcut)</option>
            <option>Cyber Security Basics</option>
            <option>YouTube Content Creation & Video Editing</option>
            <option>Freelancing & Upwork/Fiverr Training</option>
            <option>Data Analytics with Power BI</option>
            <option>Cyber Caf√© Management & Online Form Filling</option>
            <option>Mobile App Development (MIT App Inventor / Android Studio)</option>
          </select>
        </div>
        <div>
          <label>Address:</label>
          <input type="text" name="address">
        </div>
      </div>

      <div class="row">
        <div>
          <label>Mobile No:</label>
          <input type="text" name="mobile" required>
        </div>
        <div>
          <label>Date of Birth:</label>
          <input type="date" name="dob" required>
        </div>
      </div>

      <div class="submit-btn">
        <button type="button" id="clearForm">CLEAR</button>
        <button type="submit" id="submitForm">SUBMIT</button>
      </div>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.js"></script>
<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbxvK4QQzU2vrIlFmU7KXENdcUWfnfbtNVVmTYyISSh1vWDNMLkftAqHp3g1sqlMy0cB/exec";
  const loadingOverlay = document.getElementById("loadingOverlay");
  const photoInput = document.getElementById("photoInput");
  const photoPreview = document.getElementById("photoPreview");
  const cropperButtons = document.getElementById("cropperButtons");
  const finalCropped = document.getElementById("finalCropped");
  let cropper;

  photoInput.addEventListener("change", e => {
    const file = e.target.files[0];
    if(file){
      const reader = new FileReader();
      reader.onload = function(event){
        photoPreview.src = event.target.result;
        photoPreview.style.display = "block";
        if(cropper) cropper.destroy();
        cropper = new Cropper(photoPreview, { aspectRatio:1, viewMode:1, autoCropArea:0.8 });
        cropperButtons.style.display = "flex";
        finalCropped.style.display = "none";
      }
      reader.readAsDataURL(file);
    }
  });

  document.getElementById("zoomIn").addEventListener("click", ()=>{ cropper.zoom(0.1); });
  document.getElementById("zoomOut").addEventListener("click", ()=>{ cropper.zoom(-0.1); });
  document.getElementById("rotate").addEventListener("click", ()=>{ cropper.rotate(45); });

  document.getElementById("cropButton").addEventListener("click", ()=>{
    const croppedDataUrl = cropper.getCroppedCanvas({width:300,height:300}).toDataURL("image/jpeg");
    finalCropped.src = croppedDataUrl;
    finalCropped.style.display = "block";
    cropper.destroy();
    cropper = null;
    photoPreview.style.display = "none";
    cropperButtons.style.display = "none";
  });

  document.getElementById("clearForm").addEventListener("click", ()=>{
    const form = document.getElementById("studentForm");
    form.reset();
    finalCropped.src = ""; finalCropped.style.display = "none";
    photoPreview.src = ""; photoPreview.style.display = "none";
    if(cropper){ cropper.destroy(); cropper=null; }
    cropperButtons.style.display="none";
  });

  document.getElementById("studentForm").addEventListener("submit", async e=>{
    e.preventDefault();
    loadingOverlay.classList.add("active");
    const form = e.target;
    const formData = new FormData(form);
    let base64Photo = finalCropped.src ? finalCropped.src.split(",")[1] : "";
    const data = {
      centerCode: formData.get("centerCode"),
      name: formData.get("name"),
      fatherName: formData.get("fatherName"),
      course: formData.get("course"),
      admissionDate: formData.get("admissionDate"),
      gender: formData.get("gender"),
      address: formData.get("address"),
      mobile: formData.get("mobile"),
      dob: formData.get("dob"),
      photo: base64Photo
    };
    fetch(scriptURL, { method:"POST", body:new URLSearchParams(data) })
      .then(res=>res.json())
      .then(res=>{
        loadingOverlay.classList.remove("active");
        if(res.result==="success"){ alert("‚úÖ Data Saved Successfully!\nPhoto URL: "+res.url); form.reset(); finalCropped.style.display="none"; }
        else alert("‚ùå Error: "+res.message);
      })
      .catch(err=>{
        loadingOverlay.classList.remove("active");
        alert("Error: "+err.message);
      });
  });
</script>
</body>
</html>
